#!/bin/bash

POKEMON_LIST=("bulbasaur" "ivysaur" "venusaur" "charmander" "charmeleon")

API_URL="https://pokeapi.co/api/v2/pokemon"

for pokemon in "${POKEMON_LIST[@]}"; do
    echo "Fetching data for $pokemon..."

    OUTPUT_FILE="${pokemon}.json"

    # Fetch data with curl
    curl -s -o "$OUTPUT_FILE" "$API_URL/$pokemon"

    # Check if curl succeeded
    if [ $? -ne 0 ]; then
        echo "Error: Failed to fetch $pokemon" >> errors.txt
        continue
    fi

    # This validates JSON
    if ! jq empty "$OUTPUT_FILE" 2>/dev/null; then
        echo "Error: Invalid JSON for $pokemon" >> errors.txt
        continue
    fi

    echo "Saved to $OUTPUT_FILE"

    # This line delays to avoid rate limiting
    sleep 1
done

echo "Done!"
